<!DOCTYPE html>
<html>

<head>
	<title>Magic Bar Simple Test</title>
</head>

<body>
	<h1>Magic Bar Simple Test</h1>

	<script>
		// Inline bootloader with absolute paths
		(function () {
			const config = {
				appName: 'MagicBar',
				version: '1.0.0',
				cssUrl: 'http://localhost:4174/magic-bar.css',
				jsUrl: 'http://localhost:4174/magic-bar.js',
				containerId: 'magic-bar-container'
			};

			function createContainer() {
				const container = document.createElement('div');
				container.id = config.containerId;
				document.body.appendChild(container);
				return container;
			}

			function loadCSS(url) {
				return new Promise((resolve, reject) => {
					const link = document.createElement('link');
					link.rel = 'stylesheet';
					link.href = url;

					link.onload = () => {
						console.log('CSS loaded successfully:', url);
						resolve();
					};
					link.onerror = (e) => {
						console.error('Failed to load CSS:', url, e);
						reject(new Error(`Failed to load CSS: ${url}`));
					};

					document.head.appendChild(link);
				});
			}

			function loadJS(url) {
				return new Promise((resolve, reject) => {
					const script = document.createElement('script');
					script.type = 'text/javascript';
					script.src = url;

					script.onload = () => {
						console.log('JavaScript loaded successfully:', url);
						resolve();
					};
					script.onerror = (e) => {
						console.error('Failed to load JavaScript:', url, e);
						reject(new Error(`Failed to load JavaScript: ${url}`));
					};

					document.body.appendChild(script);
				});
			}

			async function init() {
				try {
					console.log('Initializing Magic Bar...');

					// Create container
					const container = createContainer();

					// Load CSS first
					console.log('Loading CSS from:', config.cssUrl);
					await loadCSS(config.cssUrl);

					// Then load JavaScript
					console.log('Loading JS from:', config.jsUrl);
					await loadJS(config.jsUrl);

					// Initialize the app
					console.log('Checking for MagicBar object...');
					if (window[config.appName] && typeof window[config.appName].init === 'function') {
						console.log('Initializing MagicBar app...');
						window[config.appName].init(container);
						console.log('MagicBar initialized successfully!');
					} else {
						console.error(`${config.appName} application not found or init method not available`);
					}
				} catch (error) {
					console.error('Failed to initialize Magic Bar:', error);
				}
			}

			// Run when DOM is ready
			if (document.readyState === 'loading') {
				document.addEventListener('DOMContentLoaded', init);
			} else {
				init();
			}
		})();
	</script>

	<div style="margin-top: 30px; padding: 10px; background: #eee;">
		<p>Check the browser console (F12) for debugging information.</p>
	</div>
</body>

</html>